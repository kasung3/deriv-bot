(()=>{var e={};e.id=702,e.ids=[702],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},29762:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>o}),s(6669),s(77564),s(35866);var a=s(23191),r=s(88716),i=s(37922),n=s.n(i),l=s(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6669)),"/home/ubuntu/deriv_trading_bot/nextjs_space/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,77564)),"/home/ubuntu/deriv_trading_bot/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ubuntu/deriv_trading_bot/nextjs_space/app/dashboard/page.tsx"],u="/dashboard/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},96164:(e,t,s)=>{Promise.resolve().then(s.bind(s,11996))},38761:(e,t,s)=>{Promise.resolve().then(s.bind(s,17493))},52800:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},11996:(e,t,s)=>{"use strict";s.d(t,{default:()=>er});var a=s(10326),r=s(17577),i=s(77109),n=s(16856),l=s(77506),c=s(17069),o=s(62881);let d=(0,o.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),u=(0,o.Z)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),m=(0,o.Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),x=(0,o.Z)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),h=(0,o.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),p=(0,o.Z)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),y=(0,o.Z)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),f=(0,o.Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),g=(0,o.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),b=(0,o.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),j=[{symbol:"R_10",name:"Volatility 10 Index"},{symbol:"R_25",name:"Volatility 25 Index"},{symbol:"R_50",name:"Volatility 50 Index"},{symbol:"R_75",name:"Volatility 75 Index"},{symbol:"R_100",name:"Volatility 100 Index"},{symbol:"1HZ10V",name:"Volatility 10 (1s) Index"},{symbol:"1HZ25V",name:"Volatility 25 (1s) Index"},{symbol:"1HZ50V",name:"Volatility 50 (1s) Index"},{symbol:"1HZ75V",name:"Volatility 75 (1s) Index"},{symbol:"1HZ100V",name:"Volatility 100 (1s) Index"}];function v(e,t){return e?.length<t?0:e.slice(-t).reduce((e,t)=>e+t,0)/t}let N=(0,o.Z)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),k=(0,o.Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),w=(0,o.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),S=(0,o.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),P=(0,o.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function T({tokens:e,onUpdate:t,disabled:s}){let[i,n]=(0,r.useState)(e),[c,o]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[g,b]=(0,r.useState)(!1),j=async e=>{let s="demo"===e?x:p,a="demo"===e?f:b,r="demo"===e?i.demo:i.live;s(!0);try{(await fetch("/api/tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokenType:e,token:r})})).ok&&(t(i),a(!0),setTimeout(()=>a(!1),2e3))}catch(e){console.error("Failed to save token:",e)}finally{s(!1)}};return(0,a.jsxs)("div",{className:"card space-y-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(N,{className:"w-5 h-5 text-fuchsia-400"}),"API Tokens"]}),s&&a.jsx("div",{className:"bg-yellow-600/20 border border-yellow-600/30 text-yellow-400 px-3 py-2 rounded-lg text-sm",children:"Stop trading to modify tokens"}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:["Get your API tokens from"," ",a.jsx("a",{href:"https://app.deriv.com/account/api-token",target:"_blank",rel:"noopener noreferrer",className:"text-fuchsia-400 hover:text-fuchsia-300",children:"Deriv Account Settings"})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Demo Account Token"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("input",{type:c?"text":"password",value:i?.demo??"",onChange:e=>n(t=>({...t,demo:e.target.value})),className:"input-field pr-20",placeholder:"Enter demo API token",disabled:s}),a.jsx("button",{onClick:()=>o(!c),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white p-2",children:c?a.jsx(k,{className:"w-5 h-5"}):a.jsx(w,{className:"w-5 h-5"})})]}),a.jsx("button",{onClick:()=>j("demo"),disabled:s||m||!i?.demo,className:"btn-primary w-full mt-3 flex items-center justify-center gap-2 text-sm py-2",children:m?a.jsx(l.Z,{className:"w-4 h-4 animate-spin"}):y?(0,a.jsxs)(a.Fragment,{children:[a.jsx(S,{className:"w-4 h-4"})," Saved!"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(P,{className:"w-4 h-4"})," Save Demo Token"]})})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-4 border border-red-900/30",children:[a.jsx("label",{className:"block text-sm font-medium text-red-400 mb-2",children:"Live Account Token"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("input",{type:d?"text":"password",value:i?.live??"",onChange:e=>n(t=>({...t,live:e.target.value})),className:"input-field pr-20 border-red-900/50",placeholder:"Enter live API token",disabled:s}),a.jsx("button",{onClick:()=>u(!d),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white p-2",children:d?a.jsx(k,{className:"w-5 h-5"}):a.jsx(w,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"bg-red-900/20 text-red-400 text-xs p-2 rounded mt-2",children:"⚠️ Use with caution. Real money at risk."}),a.jsx("button",{onClick:()=>j("live"),disabled:s||h||!i?.live,className:"bg-red-600 hover:bg-red-700 text-white w-full mt-3 py-2 rounded-lg font-medium flex items-center justify-center gap-2 text-sm transition-colors disabled:opacity-50",children:h?a.jsx(l.Z,{className:"w-4 h-4 animate-spin"}):g?(0,a.jsxs)(a.Fragment,{children:[a.jsx(S,{className:"w-4 h-4"})," Saved!"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(P,{className:"w-4 h-4"})," Save Live Token"]})})]})]})}function C({settings:e,onUpdate:t,disabled:s}){let[i,n]=(0,r.useState)(e),[c,o]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),m=async()=>{o(!0),await t(i),o(!1),u(!0),setTimeout(()=>u(!1),2e3)},x=(e,t)=>{n(s=>({...s,[e]:t}))};return(0,a.jsxs)("div",{className:"card space-y-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(g,{className:"w-5 h-5 text-fuchsia-400"}),"Trading Settings"]}),s&&a.jsx("div",{className:"bg-yellow-600/20 border border-yellow-600/30 text-yellow-400 px-3 py-2 rounded-lg text-sm",children:"Stop trading to modify settings"}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Stake & Martingale"}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Initial Stake ($)"}),a.jsx("input",{type:"number",value:i?.initialStake??1,onChange:e=>x("initialStake",parseFloat(e.target.value)||1),className:"input-field",min:"0.01",step:"0.01",disabled:s})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Martingale Factor"}),a.jsx("input",{type:"number",value:i?.martingaleFactor??2,onChange:e=>x("martingaleFactor",parseFloat(e.target.value)||2),className:"input-field",min:"1",step:"0.1",disabled:s})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"ATR Threshold"}),a.jsx("input",{type:"number",value:i?.atrThreshold??5e-4,onChange:e=>x("atrThreshold",parseFloat(e.target.value)||5e-4),className:"input-field",min:"0",step:"0.0001",disabled:s})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Risk Management"}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm text-gray-300",children:"Max Consecutive Losses"}),a.jsx("button",{onClick:()=>x("maxConsecutiveLossesEnabled",!i?.maxConsecutiveLossesEnabled),disabled:s,className:`toggle-switch ${i?.maxConsecutiveLossesEnabled?"active":""}`})]}),i?.maxConsecutiveLossesEnabled&&a.jsx("input",{type:"number",value:i?.maxConsecutiveLosses??5,onChange:e=>x("maxConsecutiveLosses",parseInt(e.target.value)||5),className:"input-field mt-2",min:"1",disabled:s})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm text-gray-300",children:"Max Stake Cap ($)"}),a.jsx("button",{onClick:()=>x("maxStakeEnabled",!i?.maxStakeEnabled),disabled:s,className:`toggle-switch ${i?.maxStakeEnabled?"active":""}`})]}),i?.maxStakeEnabled&&a.jsx("input",{type:"number",value:i?.maxStake??100,onChange:e=>x("maxStake",parseFloat(e.target.value)||100),className:"input-field mt-2",min:"1",step:"1",disabled:s})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm text-gray-300",children:"Daily Loss Limit ($)"}),a.jsx("button",{onClick:()=>x("dailyLossLimitEnabled",!i?.dailyLossLimitEnabled),disabled:s,className:`toggle-switch ${i?.dailyLossLimitEnabled?"active":""}`})]}),i?.dailyLossLimitEnabled&&a.jsx("input",{type:"number",value:i?.dailyLossLimit??50,onChange:e=>x("dailyLossLimit",parseFloat(e.target.value)||50),className:"input-field mt-2",min:"1",step:"1",disabled:s})]})]}),a.jsx("button",{onClick:m,disabled:s||c,className:"btn-primary w-full flex items-center justify-center gap-2",children:c?a.jsx(l.Z,{className:"w-5 h-5 animate-spin"}):d?"Saved!":(0,a.jsxs)(a.Fragment,{children:[a.jsx(P,{className:"w-5 h-5"})," Save Settings"]})})]})}let _=(0,o.Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),E=(0,o.Z)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),R=(0,o.Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),L=(0,o.Z)("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);function O({botState:e,settings:t}){let s=j.find(e=>e.symbol===t?.selectedMarket)?.name||"Unknown";return(0,a.jsxs)("div",{className:"card space-y-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(f,{className:"w-5 h-5 text-fuchsia-400"}),"Trading Status"]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Status"}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${{STOPPED:"bg-gray-600",RUNNING:"bg-green-500",PAUSED:"bg-yellow-500"}[e?.status??"STOPPED"]} text-white`,children:e?.status??"STOPPED"})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[a.jsx(b,{className:"w-4 h-4"}),"Balance"]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-white",children:["$",(e?.balance??0).toFixed(2)]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-3",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Session P/L"}),(0,a.jsxs)("div",{className:`text-lg font-semibold ${(e?.sessionProfit??0)>=0?"text-green-400":"text-red-400"}`,children:[(e?.sessionProfit??0)>=0?"+":"","$",(e?.sessionProfit??0).toFixed(2)]})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-3",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"All-Time P/L"}),(0,a.jsxs)("div",{className:`text-lg font-semibold ${(e?.allTimeProfit??0)>=0?"text-green-400":"text-red-400"}`,children:[(e?.allTimeProfit??0)>=0?"+":"","$",(e?.allTimeProfit??0).toFixed(2)]})]})]}),e?.currentTrade&&(0,a.jsxs)(n.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-fuchsia-900/30 border border-fuchsia-600/30 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-fuchsia-300 text-sm font-medium mb-2",children:[a.jsx(_,{className:"w-4 h-4"}),"Active Trade"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-400",children:"Direction:"}),a.jsx("span",{className:`ml-2 font-medium ${e.currentTrade?.direction==="RISE"?"text-green-400":"text-red-400"}`,children:e.currentTrade?.direction??"N/A"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-400",children:"Stake:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium text-white",children:["$",(e.currentTrade?.stake??0).toFixed(2)]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-400 flex items-center gap-2",children:[a.jsx(E,{className:"w-4 h-4"}),"Current Stake"]}),(0,a.jsxs)("span",{className:"font-medium text-white",children:["$",(e?.currentStake??1).toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-400 flex items-center gap-2",children:[a.jsx(R,{className:"w-4 h-4"}),"Consecutive Losses"]}),a.jsx("span",{className:`font-medium ${(e?.consecutiveLosses??0)>=3?"text-red-400":"text-white"}`,children:e?.consecutiveLosses??0})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-400 flex items-center gap-2",children:[a.jsx(L,{className:"w-4 h-4"}),"Market"]}),a.jsx("span",{className:"font-medium text-white text-right",children:s})]})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-4",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Market Condition"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e?.marketCondition?.trending?"bg-green-600/30 text-green-400":"bg-yellow-600/30 text-yellow-400"}`,children:e?.marketCondition?.trending?"Trending":"Sideways"}),(0,a.jsxs)("span",{className:`px-2 py-1 rounded text-xs font-medium ${e?.marketCondition?.volatility==="HIGH"?"bg-fuchsia-600/30 text-fuchsia-400":"bg-gray-600/30 text-gray-400"}`,children:[e?.marketCondition?.volatility??"LOW"," Volatility"]})]})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-4",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Indicators"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-gray-400 text-xs",children:"SMA 5"}),a.jsx("div",{className:"font-medium text-green-400",children:(e?.sma5??0).toFixed(5)})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-gray-400 text-xs",children:"SMA 6"}),a.jsx("div",{className:"font-medium text-red-400",children:(e?.sma6??0).toFixed(5)})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-gray-400 text-xs",children:"ATR"}),a.jsx("div",{className:"font-medium text-fuchsia-400",children:(e?.atr??0).toFixed(6)})]})]})]}),(0,a.jsxs)("div",{className:"bg-[#252542] rounded-lg p-3",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Last Signal"}),a.jsx("div",{className:"text-sm text-white",children:e?.lastSignal??"Waiting..."})]})]})}let M=(0,o.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),A=(0,o.Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);function F({trades:e}){let t=e=>{try{return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return"--:--"}},s=e=>j.find(t=>t.symbol===e)?.name?.split(" ").slice(0,2).join(" ")||e;return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 mb-4",children:[a.jsx(M,{className:"w-5 h-5 text-fuchsia-400"}),"Recent Trades"]}),e&&0!==e.length?a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"text-gray-400 text-left border-b border-gray-700",children:[a.jsx("th",{className:"pb-2 font-medium",children:"Time"}),a.jsx("th",{className:"pb-2 font-medium",children:"Market"}),a.jsx("th",{className:"pb-2 font-medium",children:"Direction"}),a.jsx("th",{className:"pb-2 font-medium",children:"Stake"}),a.jsx("th",{className:"pb-2 font-medium text-right",children:"P/L"})]})}),a.jsx("tbody",{children:(e??[]).map((e,r)=>(0,a.jsxs)(n.E.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*r},className:`border-b border-gray-800 ${e?.result==="WIN"?"bg-green-900/10":e?.result==="LOSS"?"bg-red-900/10":""}`,children:[a.jsx("td",{className:"py-3 text-gray-300",children:t(e?.entryTime??new Date)}),a.jsx("td",{className:"py-3 text-gray-300",children:s(e?.market??"")}),a.jsx("td",{className:"py-3",children:(0,a.jsxs)("span",{className:`flex items-center gap-1 ${e?.direction==="RISE"?"text-green-400":"text-red-400"}`,children:[e?.direction==="RISE"?a.jsx(c.Z,{className:"w-4 h-4"}):a.jsx(A,{className:"w-4 h-4"}),e?.direction??"N/A"]})}),(0,a.jsxs)("td",{className:"py-3 text-gray-300",children:["$",(e?.stake??0).toFixed(2)]}),a.jsx("td",{className:`py-3 text-right font-medium ${e?.result==="WIN"?"text-green-400":e?.result==="LOSS"?"text-red-400":"text-yellow-400"}`,children:e?.result==="PENDING"?"Pending...":`${(e?.profit??0)>=0?"+":""}$${(e?.profit??0).toFixed(2)}`})]},e?.id||r))})]})}):a.jsx("div",{className:"text-center text-gray-400 py-8",children:"No trades yet. Start the bot to begin trading."})]})}var $=s(43353),I=s.n($);let D=(0,o.Z)("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),U=(0,o.Z)("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),Z=I()(async()=>{},{loadableGenerated:{modules:["components/charts.tsx -> ./recharts-wrapper"]},ssr:!1,loading:()=>a.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"Loading charts..."})});function q({candles:e,sma5:t,sma6:s,stats:r,trades:i}){return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card col-span-1 md:col-span-2",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 mb-4",children:[a.jsx(D,{className:"w-5 h-5 text-fuchsia-400"}),"Price Chart (1-Min Candles)"]}),a.jsx("div",{className:"h-[250px]",children:a.jsx(Z,{type:"candles",candles:e??[],sma5:t??0,sma6:s??0})})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 mb-4",children:[a.jsx(c.Z,{className:"w-5 h-5 text-fuchsia-400"}),"Balance History"]}),a.jsx("div",{className:"h-[200px]",children:a.jsx(Z,{type:"balance",balanceHistory:r?.balanceHistory??[]})})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 mb-4",children:[a.jsx(U,{className:"w-5 h-5 text-fuchsia-400"}),"Win/Loss Ratio"]}),a.jsx("div",{className:"h-[200px]",children:a.jsx(Z,{type:"winLoss",wins:r?.wins??0,losses:r?.losses??0,winRate:r?.winRate??0})})]})]})}var z=s(42482);function G(){let e=(0,r.useRef)(!1);return(0,z.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var H=s(80805),V=s(40295),W=s(74749);class B extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function J({children:e,isPresent:t}){let s=(0,r.useId)(),a=(0,r.useRef)(null),i=(0,r.useRef)({width:0,height:0,top:0,left:0});return(0,r.useInsertionEffect)(()=>{let{width:e,height:r,top:n,left:l}=i.current;if(t||!a.current||!e||!r)return;a.current.dataset.motionPopId=s;let c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${r}px !important;
            top: ${n}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),r.createElement(B,{isPresent:t,childRef:a,sizeRef:i},r.cloneElement(e,{ref:a}))}let X=({children:e,initial:t,isPresent:s,onExitComplete:a,custom:i,presenceAffectsLayout:n,mode:l})=>{let c=(0,W.h)(K),o=(0,r.useId)(),d=(0,r.useMemo)(()=>({id:o,initial:t,isPresent:s,custom:i,onExitComplete:e=>{for(let t of(c.set(e,!0),c.values()))if(!t)return;a&&a()},register:e=>(c.set(e,!1),()=>c.delete(e))}),n?void 0:[s]);return(0,r.useMemo)(()=>{c.forEach((e,t)=>c.set(t,!1))},[s]),r.useEffect(()=>{s||c.size||!a||a()},[s]),"popLayout"===l&&(e=r.createElement(J,{isPresent:s},e)),r.createElement(V.O.Provider,{value:d},e)};function K(){return new Map}var Q=s(40339),Y=s(24673);let ee=e=>e.key||"",et=({children:e,custom:t,initial:s=!0,onExitComplete:a,exitBeforeEnter:i,presenceAffectsLayout:n=!0,mode:l="sync"})=>{var c;(0,Y.k)(!i,"Replace exitBeforeEnter with mode='wait'");let o=(0,r.useContext)(Q.p).forceRender||function(){let e=G(),[t,s]=(0,r.useState)(0),a=(0,r.useCallback)(()=>{e.current&&s(t+1)},[t]);return[(0,r.useCallback)(()=>H.Wi.postRender(a),[a]),t]}()[0],d=G(),u=function(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}(e),m=u,x=(0,r.useRef)(new Map).current,h=(0,r.useRef)(m),p=(0,r.useRef)(new Map).current,y=(0,r.useRef)(!0);if((0,z.L)(()=>{y.current=!1,function(e,t){e.forEach(e=>{let s=ee(e);t.set(s,e)})}(u,p),h.current=m}),c=()=>{y.current=!0,p.clear(),x.clear()},(0,r.useEffect)(()=>()=>c(),[]),y.current)return r.createElement(r.Fragment,null,m.map(e=>r.createElement(X,{key:ee(e),isPresent:!0,initial:!!s&&void 0,presenceAffectsLayout:n,mode:l},e)));m=[...m];let f=h.current.map(ee),g=u.map(ee),b=f.length;for(let e=0;e<b;e++){let t=f[e];-1!==g.indexOf(t)||x.has(t)||x.set(t,void 0)}return"wait"===l&&x.size&&(m=[]),x.forEach((e,s)=>{if(-1!==g.indexOf(s))return;let i=p.get(s);if(!i)return;let c=f.indexOf(s),y=e;y||(y=r.createElement(X,{key:ee(i),isPresent:!1,onExitComplete:()=>{x.delete(s);let e=Array.from(p.keys()).filter(e=>!g.includes(e));if(e.forEach(e=>p.delete(e)),h.current=u.filter(t=>{let a=ee(t);return a===s||e.includes(a)}),!x.size){if(!1===d.current)return;o(),a&&a()}},custom:t,presenceAffectsLayout:n,mode:l},i),x.set(s,y)),m.splice(c,0,y)}),m=m.map(e=>{let t=e.key;return x.has(t)?e:r.createElement(X,{key:ee(e),isPresent:!0,presenceAffectsLayout:n,mode:l},e)}),r.createElement(r.Fragment,null,x.size?m:m.map(e=>(0,r.cloneElement)(e)))},es=(0,o.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ea({open:e,message:t,onConfirm:s,onCancel:r}){return a.jsx(et,{children:e&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:r,children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-[#1a1a2e] rounded-xl p-6 max-w-md w-full shadow-xl border border-fuchsia-900/30",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"p-2 bg-fuchsia-600/20 rounded-lg",children:a.jsx(R,{className:"w-6 h-6 text-fuchsia-400"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Confirm Action"}),a.jsx("p",{className:"text-gray-400",children:t||"Are you sure?"})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:a.jsx(es,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[a.jsx("button",{onClick:r,className:"flex-1 py-2 px-4 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:s,className:"flex-1 btn-primary",children:"Confirm"})]})]})})})}function er(){let{data:e,status:t}=(0,i.useSession)()||{},[s,o]=(0,r.useState)(!1),[N,k]=(0,r.useState)(null),[w,S]=(0,r.useState)({demo:"",live:""}),[P,_]=(0,r.useState)({status:"STOPPED",balance:0,sessionProfit:0,allTimeProfit:0,consecutiveLosses:0,currentStake:1,currentTrade:null,marketCondition:{trending:!1,volatility:"LOW"},sma5:0,sma6:0,atr:0,lastSignal:"Waiting for data..."}),[E,R]=(0,r.useState)([]),[L,M]=(0,r.useState)([]),[A,$]=(0,r.useState)(!0),[I,D]=(0,r.useState)({open:!1,action:"",message:""}),[U,Z]=(0,r.useState)("status"),[z,G]=(0,r.useState)({allTimeProfit:0,sessionProfit:0,wins:0,losses:0,winRate:0,balanceHistory:[]}),[H,V]=(0,r.useState)("server"),[W,B]=(0,r.useState)({isActive:!1,status:"STOPPED",balance:0,sessionProfit:0,consecutiveLosses:0,currentStake:1,lastSignal:"Not started"}),[J,X]=(0,r.useState)(!1),K=(0,r.useRef)(null),Q=(0,r.useRef)([]),Y=(0,r.useRef)(P),ee=(0,r.useRef)(N),et=(0,r.useRef)(1),es=(0,r.useRef)(null),er=(0,r.useRef)(0),ei=(0,r.useCallback)(async()=>{X(!0);try{let e=await fetch("/api/server-trading/start",{method:"POST"}),t=await e.json();e.ok?B(e=>({...e,isActive:!0,status:"RUNNING",lastSignal:"Starting..."})):alert(t.error||"Failed to start trading")}catch(e){console.error("Failed to start server trading:",e),alert("Failed to start trading")}finally{X(!1)}},[]),en=(0,r.useCallback)(async()=>{X(!0);try{let e=await fetch("/api/server-trading/stop",{method:"POST"}),t=await e.json();e.ok?B(e=>({...e,isActive:!1,status:"STOPPED",lastSignal:"Stopped"})):alert(t.error||"Failed to stop trading")}catch(e){console.error("Failed to stop server trading:",e),alert("Failed to stop trading")}finally{X(!1)}},[]),el=(0,r.useCallback)(()=>{if(!N||!w)return;let e="demo"===N.accountType?w.demo:w.live;if(!e){_(e=>({...e,lastSignal:"No API token configured for "+N.accountType+" account"}));return}K.current?.readyState===WebSocket.OPEN&&K.current.close();let t=new WebSocket("wss://ws.binaryws.com/websockets/v3?app_id=1089");K.current=t,t.onopen=()=>{t.send(JSON.stringify({authorize:e}))},t.onmessage=e=>{ec(JSON.parse(e.data))},t.onerror=e=>{console.error("WebSocket error:",e),_(e=>({...e,lastSignal:"Connection error"}))},t.onclose=()=>{"RUNNING"===Y.current.status&&setTimeout(el,3e3)}},[N,w]),ec=(0,r.useCallback)(e=>{let t=e?.msg_type;if(e.error){console.error("Deriv API error:",e.error),_(t=>({...t,lastSignal:`Error: ${e.error.message||"Unknown"}`}));return}switch(t){case"authorize":_(t=>({...t,balance:e.authorize?.balance||0})),K.current?.send(JSON.stringify({balance:1,subscribe:1}));let s=ee.current?.selectedMarket||"R_10";K.current?.send(JSON.stringify({ticks_history:s,count:20,end:"latest",granularity:60,style:"candles",subscribe:1}));break;case"balance":_(t=>({...t,balance:e.balance?.balance||t.balance}));break;case"candles":if(e.candles?.length){let t=e.candles.map(e=>({epoch:e.epoch,open:parseFloat(e.open),high:parseFloat(e.high),low:parseFloat(e.low),close:parseFloat(e.close)}));M(t),Q.current=t,t.length>0&&(er.current=t[t.length-1].epoch),eo()}break;case"ohlc":if(e.ohlc){let t={epoch:e.ohlc.epoch,open:parseFloat(e.ohlc.open),high:parseFloat(e.ohlc.high),low:parseFloat(e.ohlc.low),close:parseFloat(e.ohlc.close)};if(t.epoch>er.current){er.current=t.epoch;let e=[...Q.current.slice(-19),t];M(e),Q.current=e,eo()}else{let e=[...Q.current];e.length>0&&(e[e.length-1]=t,M(e),Q.current=e)}}break;case"buy":if(e.buy){es.current=e.buy.contract_id?.toString();let t={id:"",contractId:e.buy.contract_id?.toString(),market:ee.current?.selectedMarket||"R_10",direction:Y.current.currentTrade?.direction||"RISE",stake:e.buy.buy_price||et.current,entryTime:new Date,result:"PENDING",accountType:ee.current?.accountType||"demo",sma5:Y.current.sma5,sma6:Y.current.sma6,atr:Y.current.atr};_(e=>({...e,currentTrade:t,lastSignal:`Trade placed: ${t.direction} at $${t.stake}`})),eu(t),K.current?.send(JSON.stringify({proposal_open_contract:1,contract_id:e.buy.contract_id,subscribe:1}))}break;case"proposal_open_contract":if(e.proposal_open_contract?.status==="sold"||e.proposal_open_contract?.is_sold){var a,r,i,n,l,c;let t;let s=e.proposal_open_contract,o=s.profit||0,d=o>0;em(s.contract_id?.toString(),d?"WIN":"LOSS",o,s.exit_tick||0);let u=d?0:Y.current.consecutiveLosses+1,m=(a=d?"WIN":"LOSS",r=et.current,i=ee.current?.initialStake||1,n=ee.current?.martingaleFactor||2,l=ee.current?.maxStake||100,c=ee.current?.maxStakeEnabled||!0,t=i,"LOSS"===a&&(t=r*n),c&&t>l&&(t=l),Math.round(100*t)/100);et.current=d?ee.current?.initialStake||1:m,_(e=>({...e,consecutiveLosses:u,currentStake:et.current,currentTrade:null,sessionProfit:e.sessionProfit+o,allTimeProfit:e.allTimeProfit+o,lastSignal:`Trade ${d?"WON":"LOST"}: ${o>=0?"+":""}$${o.toFixed(2)}`})),es.current=null,eh(u,o),ex()}}},[]),eo=(0,r.useCallback)(()=>{if("RUNNING"!==Y.current.status||es.current)return;if(Q.current.length<10){_(e=>({...e,lastSignal:`Waiting for candles (${Q.current.length}/10)`}));return}let e=Q.current.map(e=>e.close),t=v(e,5),s=v(e,6),a=function(e,t=14){if(!e||e.length<t+1)return 0;let s=[];for(let t=1;t<e.length;t++){let a=e[t],r=e[t-1],i=Math.max(a.high-a.low,Math.abs(a.high-r.close),Math.abs(a.low-r.close));s.push(i)}let a=s.slice(-t);return a.reduce((e,t)=>e+t,0)/a.length}(Q.current,14),r=ee.current?.atrThreshold||5e-4;_(e=>({...e,sma5:t,sma6:s,atr:a,marketCondition:{trending:Math.abs(t-s)>r,volatility:a>r?"HIGH":"LOW"}}));let{direction:i,reason:n}=a<r?{direction:null,reason:"Low volatility - ATR below threshold"}:t>s?{direction:"RISE",reason:"SMA5 crossed above SMA6 - Bullish"}:t<s?{direction:"FALL",reason:"SMA5 crossed below SMA6 - Bearish"}:{direction:null,reason:"No clear signal - SMAs equal"};_(e=>({...e,lastSignal:n})),i&&K.current?.readyState===WebSocket.OPEN&&ed(i)},[]),ed=(0,r.useCallback)(e=>{let t=ee.current?.selectedMarket||"R_10",s=et.current;_(a=>({...a,currentTrade:{id:"",market:t,direction:e,stake:s,entryTime:new Date,result:"PENDING",accountType:ee.current?.accountType||"demo"}})),K.current?.send(JSON.stringify({buy:1,price:s,parameters:{contract_type:"RISE"===e?"CALL":"PUT",symbol:t,duration:1,duration_unit:"m",basis:"stake",amount:s,currency:"USD"}}))},[]),eu=async e=>{try{let t=await fetch("/api/trades",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();_(t=>({...t,currentTrade:t.currentTrade?{...t.currentTrade,id:e.id}:null}))}}catch(e){console.error("Failed to save trade:",e)}},em=async(e,t,s,a)=>{let r=Y.current.currentTrade;if(r?.id)try{await fetch(`/api/trades/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({result:t,profit:s,exitPrice:a,exitTime:new Date})})}catch(e){console.error("Failed to update trade:",e)}},ex=async()=>{try{let e=await fetch("/api/trades?limit=10");e.ok&&R(await e.json())}catch(e){console.error("Failed to refresh trades:",e)}},eh=(0,r.useCallback)((e,t)=>{let s=ee.current;if(s){if(s.maxConsecutiveLossesEnabled&&e>=s.maxConsecutiveLosses){eg(),_(e=>({...e,lastSignal:`Stopped: Max consecutive losses (${s.maxConsecutiveLosses}) reached`}));return}s.dailyLossLimitEnabled&&Y.current.sessionProfit<=-s.dailyLossLimit&&(eg(),_(e=>({...e,lastSignal:`Stopped: Daily loss limit ($${s.dailyLossLimit}) reached`})))}},[]),ep=(0,r.useCallback)(()=>{if(!w.demo&&!w.live){_(e=>({...e,lastSignal:"Please configure API tokens first"}));return}_(e=>({...e,status:"RUNNING",lastSignal:"Starting..."})),el()},[w,el]),ey=(0,r.useCallback)(()=>{_(e=>({...e,status:"PAUSED",lastSignal:"Trading paused"}))},[]),ef=(0,r.useCallback)(()=>{_(e=>({...e,status:"RUNNING",lastSignal:"Resuming..."}))},[]),eg=(0,r.useCallback)(()=>{_(e=>({...e,status:"STOPPED",lastSignal:"Trading stopped",currentTrade:null})),et.current=ee.current?.initialStake||1,_(e=>({...e,currentStake:et.current,consecutiveLosses:0})),K.current&&(K.current.close(),K.current=null)},[]),eb=async e=>{N&&(k({...N,selectedMarket:e}),await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({selectedMarket:e})}),"RUNNING"===P.status&&K.current&&(K.current.send(JSON.stringify({forget_all:"candles"})),K.current.send(JSON.stringify({ticks_history:e,count:20,end:"latest",granularity:60,style:"candles",subscribe:1}))))};return!s||A?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#0f0f1a]",children:a.jsx(l.Z,{className:"w-8 h-8 animate-spin text-fuchsia-500"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-[#0f0f1a]",children:[a.jsx("header",{className:"sticky top-0 z-50 bg-[#0f0f1a]/90 backdrop-blur-sm border-b border-fuchsia-900/30",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(c.Z,{className:"w-8 h-8 text-fuchsia-500"}),a.jsx("span",{className:"text-xl font-bold gradient-text",children:"Deriv Trading Bot"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-gray-400 text-sm",children:["Welcome, ",e?.user?.name||"Trader"]}),(0,a.jsxs)("button",{onClick:()=>(0,i.signOut)({callbackUrl:"/login"}),className:"flex items-center gap-2 text-gray-400 hover:text-fuchsia-400 transition-colors",children:[a.jsx(d,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsx(n.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"card mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(u,{className:"w-5 h-5 text-fuchsia-400"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-white",children:"Trading Mode"}),a.jsx("p",{className:"text-xs text-gray-400",children:"server"===H?"24/7 Server Trading - Runs even when your computer is off":"Browser Trading - Runs only while this page is open"})]})]}),(0,a.jsxs)("div",{className:"flex bg-[#252542] rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>{"STOPPED"!==P.status||W.isActive||V("browser")},disabled:"STOPPED"!==P.status||W.isActive,className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${"browser"===H?"bg-fuchsia-600 text-white":"text-gray-400 hover:text-white disabled:opacity-50"}`,children:[a.jsx(m,{className:"w-4 h-4"}),"Browser"]}),(0,a.jsxs)("button",{onClick:()=>{"STOPPED"!==P.status||W.isActive||V("server")},disabled:"STOPPED"!==P.status||W.isActive,className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${"server"===H?"bg-green-600 text-white":"text-gray-400 hover:text-white disabled:opacity-50"}`,children:[a.jsx(x,{className:"w-4 h-4"}),"24/7 Server"]})]})]})}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"card mb-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Market"}),a.jsx("select",{value:N?.selectedMarket||"R_10",onChange:e=>eb(e.target.value),className:"input-field py-2 min-w-[200px]",disabled:"RUNNING"===P.status||W.isActive,children:j.map(e=>a.jsx("option",{value:e.symbol,children:e.name},e.symbol))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Account"}),(0,a.jsxs)("div",{className:"flex bg-[#252542] rounded-lg p-1",children:[a.jsx("button",{onClick:async()=>{N&&"RUNNING"!==P.status&&!W.isActive&&(k({...N,accountType:"demo"}),await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountType:"demo"})}))},disabled:W.isActive,className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${N?.accountType==="demo"?"bg-fuchsia-600 text-white":"text-gray-400 hover:text-white"}`,children:"Demo"}),a.jsx("button",{onClick:async()=>{N&&"RUNNING"!==P.status&&!W.isActive&&(k({...N,accountType:"live"}),await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountType:"live"})}))},disabled:W.isActive,className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${N?.accountType==="live"?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:"Live"})]})]})]}),a.jsx("div",{className:"flex items-center gap-3",children:"server"===H?(0,a.jsxs)(a.Fragment,{children:[!W.isActive&&(0,a.jsxs)("button",{onClick:()=>D({open:!0,action:"server-start",message:`Start 24/7 server trading on ${N?.accountType?.toUpperCase()} account with ${j.find(e=>e.symbol===N?.selectedMarket)?.name}?

Trading will continue even when your computer is off.`}),disabled:J,className:"btn-primary flex items-center gap-2",children:[J?a.jsx(l.Z,{className:"w-5 h-5 animate-spin"}):a.jsx(h,{className:"w-5 h-5"}),"Start 24/7"]}),W.isActive&&(0,a.jsxs)("button",{onClick:()=>D({open:!0,action:"server-stop",message:"Stop 24/7 server trading?"}),disabled:J,className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2 transition-colors",children:[J?a.jsx(l.Z,{className:"w-5 h-5 animate-spin"}):a.jsx(p,{className:"w-5 h-5"}),"Stop"]})]}):(0,a.jsxs)(a.Fragment,{children:["STOPPED"===P.status&&(0,a.jsxs)("button",{onClick:()=>D({open:!0,action:"start",message:`Start trading on ${N?.accountType?.toUpperCase()} account with ${j.find(e=>e.symbol===N?.selectedMarket)?.name}?`}),className:"btn-primary flex items-center gap-2",children:[a.jsx(h,{className:"w-5 h-5"})," Start"]}),"RUNNING"===P.status&&(0,a.jsxs)("button",{onClick:ey,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2 transition-colors",children:[a.jsx(y,{className:"w-5 h-5"})," Pause"]}),"PAUSED"===P.status&&(0,a.jsxs)("button",{onClick:ef,className:"btn-primary flex items-center gap-2",children:[a.jsx(h,{className:"w-5 h-5"})," Resume"]}),"STOPPED"!==P.status&&(0,a.jsxs)("button",{onClick:()=>D({open:!0,action:"stop",message:"Stop trading? This will reset your current stake and consecutive losses count."}),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2 transition-colors",children:[a.jsx(p,{className:"w-5 h-5"})," Stop"]})]})})]}),"server"===H&&W.isActive&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-fuchsia-900/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 animate-pulse"}),a.jsx("span",{className:"text-sm font-medium",children:"24/7 Trading Active"}),(0,a.jsxs)("span",{className:"text-gray-400 text-sm",children:["• ",W.lastSignal]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mt-3",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-xs text-gray-400",children:"Balance"}),(0,a.jsxs)("div",{className:"font-medium text-white",children:["$",W.balance?.toFixed(2)||"0.00"]})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-xs text-gray-400",children:"Session P/L"}),(0,a.jsxs)("div",{className:`font-medium ${(W.sessionProfit||0)>=0?"text-green-400":"text-red-400"}`,children:[(W.sessionProfit||0)>=0?"+":"","$",(W.sessionProfit||0).toFixed(2)]})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-xs text-gray-400",children:"Current Stake"}),(0,a.jsxs)("div",{className:"font-medium text-white",children:["$",W.currentStake?.toFixed(2)||"1.00"]})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-xs text-gray-400",children:"Consecutive Losses"}),a.jsx("div",{className:`font-medium ${(W.consecutiveLosses||0)>=3?"text-red-400":"text-white"}`,children:W.consecutiveLosses||0})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[a.jsx("div",{className:"flex bg-[#1a1a2e] rounded-lg p-1",children:[{key:"status",label:"Status",icon:f},{key:"settings",label:"Settings",icon:g},{key:"tokens",label:"API Tokens",icon:b}].map(({key:e,label:t,icon:s})=>(0,a.jsxs)("button",{onClick:()=>Z(e),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-medium transition-colors ${U===e?"bg-fuchsia-600 text-white":"text-gray-400 hover:text-white"}`,children:[a.jsx(s,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:t})]},e))}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2},children:["status"===U&&a.jsx(O,{botState:P,settings:N}),"settings"===U&&N&&a.jsx(C,{settings:N,onUpdate:async e=>{k(e),await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})},disabled:"STOPPED"!==P.status}),"tokens"===U&&a.jsx(T,{tokens:w,onUpdate:e=>S(e),disabled:"STOPPED"!==P.status})]},U)]}),(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[a.jsx(q,{candles:L,sma5:P.sma5,sma6:P.sma6,stats:z,trades:E}),a.jsx(F,{trades:E})]})]})]}),a.jsx(ea,{open:I.open,message:I.message,onConfirm:()=>{switch(I.action){case"start":ep();break;case"stop":eg();break;case"server-start":ei();break;case"server-stop":en()}D({open:!1,action:"",message:""})},onCancel:()=>D({open:!1,action:"",message:""})})]})}},17493:(e,t,s)=>{"use strict";s.d(t,{Providers:()=>i});var a=s(10326),r=s(77109);function i({children:e}){return a.jsx(r.SessionProvider,{children:e})}},43353:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let a=s(91174);s(10326),s(17577);let r=a._(s(77028));function i(e,t){var s;let a={loading:e=>{let{error:t,isLoading:s,pastDelay:a}=e;return null}};"function"==typeof e&&(a.loader=e);let i={...a,...t};return(0,r.default)({...i,modules:null==(s=i.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let a=s(94129);function r(e){let{reason:t,children:s}=e;throw new a.BailoutToCSRError(t)}},77028:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let a=s(10326),r=s(17577),i=s(933),n=s(46618);function l(e){return{default:e&&"default"in e?e.default:e}}let c={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},o=function(e){let t={...c,...e},s=(0,r.lazy)(()=>t.loader().then(l)),o=t.loading;function d(e){let l=o?(0,a.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,c=t.ssr?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.PreloadCss,{moduleIds:t.modules}),(0,a.jsx)(s,{...e})]}):(0,a.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(s,{...e})});return(0,a.jsx)(r.Suspense,{fallback:l,children:c})}return d.displayName="LoadableComponent",d}},46618:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return i}});let a=s(10326),r=s(54580);function i(e){let{moduleIds:t}=e,s=(0,r.getExpectedRequestStore)("next/dynamic css"),i=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,a.jsx)(a.Fragment,{children:i.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:s.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},6669:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(19510),r=s(75571),i=s(90455),n=s(58585);let l=(0,s(68570).createProxy)(String.raw`/home/ubuntu/deriv_trading_bot/nextjs_space/components/dashboard.tsx#default`);async function c(){return await (0,r.getServerSession)(i.L)||(0,n.redirect)("/login"),a.jsx(l,{})}},77564:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,dynamic:()=>l,metadata:()=>c});var a=s(19510),r=s(85384),i=s.n(r);s(67272);let n=(0,s(68570).createProxy)(String.raw`/home/ubuntu/deriv_trading_bot/nextjs_space/components/providers.tsx#Providers`),l="force-dynamic",c={metadataBase:new URL(process.env.NEXTAUTH_URL||"http://localhost:3000"),title:"Deriv Trading Bot",description:"Automated binary options trading bot for Deriv synthetic indices",icons:{icon:"/favicon.svg",shortcut:"/favicon.svg"},openGraph:{title:"Deriv Trading Bot",description:"Automated binary options trading bot for Deriv synthetic indices",images:["/og-image.png"]}};function o({children:e}){return(0,a.jsxs)("html",{lang:"en",children:[a.jsx("head",{children:a.jsx("script",{src:"https://apps.abacus.ai/chatllm/appllm-lib.js"})}),a.jsx("body",{className:i().className,children:a.jsx(n,{children:e})})]})}},90455:(e,t,s)=>{"use strict";s.d(t,{L:()=>c});var a=s(53797),r=s(13539),i=s(9487),n=s(42023),l=s.n(n);let c={adapter:(0,r.N)(i._),providers:[(0,a.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await i._.user.findUnique({where:{email:e.email}});return t&&await l().compare(e.password,t.password)?{id:t.id,email:t.email,name:t.name}:null}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(e?.user&&t?.id&&(e.user.id=t.id),e)},pages:{signIn:"/login"}}},9487:(e,t,s)=>{"use strict";s.d(t,{_:()=>i});var a=s(53524);let r=globalThis,i=new Proxy({},{get:(e,t)=>(r.prisma||(r.prisma=new a.PrismaClient),r.prisma)[t]})},58585:(e,t,s)=>{"use strict";var a=s(61085);s.o(a,"redirect")&&s.d(t,{redirect:function(){return a.redirect}})},61085:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{ReadonlyURLSearchParams:function(){return n},RedirectType:function(){return a.RedirectType},notFound:function(){return r.notFound},permanentRedirect:function(){return a.permanentRedirect},redirect:function(){return a.redirect}});let a=s(83953),r=s(16399);class i extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class n extends URLSearchParams{append(){throw new i}delete(){throw new i}set(){throw new i}sort(){throw new i}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},16399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{isNotFoundError:function(){return r},notFound:function(){return a}});let s="NEXT_NOT_FOUND";function a(){let e=Error(s);throw e.digest=s,e}function r(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===s}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8586:(e,t)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return s}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(s||(s={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83953:(e,t,s)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{RedirectType:function(){return a},getRedirectError:function(){return c},getRedirectStatusCodeFromError:function(){return h},getRedirectTypeFromError:function(){return x},getURLFromRedirectError:function(){return m},isRedirectError:function(){return u},permanentRedirect:function(){return d},redirect:function(){return o}});let r=s(54580),i=s(72934),n=s(8586),l="NEXT_REDIRECT";function c(e,t,s){void 0===s&&(s=n.RedirectStatusCode.TemporaryRedirect);let a=Error(l);a.digest=l+";"+t+";"+e+";"+s+";";let i=r.requestAsyncStorage.getStore();return i&&(a.mutableCookies=i.mutableCookies),a}function o(e,t){void 0===t&&(t="replace");let s=i.actionAsyncStorage.getStore();throw c(e,t,(null==s?void 0:s.isAction)?n.RedirectStatusCode.SeeOther:n.RedirectStatusCode.TemporaryRedirect)}function d(e,t){void 0===t&&(t="replace");let s=i.actionAsyncStorage.getStore();throw c(e,t,(null==s?void 0:s.isAction)?n.RedirectStatusCode.SeeOther:n.RedirectStatusCode.PermanentRedirect)}function u(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,s,a,r]=e.digest.split(";",4),i=Number(r);return t===l&&("replace"===s||"push"===s)&&"string"==typeof a&&!isNaN(i)&&i in n.RedirectStatusCode}function m(e){return u(e)?e.digest.split(";",3)[2]:null}function x(e){if(!u(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function h(e){if(!u(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(a||(a={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},67272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,776,637,114,576],()=>s(29762));module.exports=a})();